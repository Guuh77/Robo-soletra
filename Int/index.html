<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel de Controle - Soletra Bot</title>
  <link rel="stylesheet" href="Robo-soletra\int\index.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Soletra Bot</h1>
      <p>Automação inteligente para o jogo Soletra da G1.</p>
    </header>
    <main>
      <div class="card description-card">
        <h2>O que é isso?</h2>
        <p>
          Este é um painel de controle para um robô automatizado (bot) escrito em Python. 
          Quando executado, o bot abre o navegador Google Chrome, navega até o jogo Soletra, 
          identifica as letras do dia, encontra todas as palavras possíveis em seu dicionário e 
          as digita para você, resolvendo o jogo em segundos.
        </p>
      </div>

      <div class="card bot-actions">
        <h2>Ações do Robô</h2>
        <ol>
          <li><span>1</span> Inicia o Google Chrome e acessa o jogo.</li>
          <li><span>2</span> Lê a letra central e as letras externas do tabuleiro.</li>
          <li><span>3</span> Procura por todas as combinações válidas em um dicionário.</li>
          <li><span>4</span> Digita e envia cada palavra encontrada, uma por uma.</li>
          <li><span>5</span> Conclui o jogo para você!</li>
        </ol>
      </div>

      <button id="start-bot-button">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>
        Iniciar Robô
      </button>

      <div id="instructions-container" class="card instructions" style="display: none;" aria-live="polite">
        <h2>Como Executar o Robô</h2>
        <p class="security-note">
          <strong>Aviso de Segurança:</strong> O seu navegador não pode executar scripts locais diretamente. 
          Siga os passos abaixo para rodar o bot no seu próprio computador.
        </p>
        
        <div class="step">
          <h3>Passo 1: Pré-requisitos</h3>
          <p>Garanta que você tenha o <strong>Python</strong> instalado. Você pode baixá-lo em <a href="https://python.org" target="_blank" rel="noopener noreferrer">python.org</a>.</p>
        </div>

        <div class="step">
            <h3>Passo 2: Instalar Dependências</h3>
            <p>Abra o terminal ou prompt de comando e execute o seguinte comando para instalar as bibliotecas necessárias:</p>
            <pre><code>pip install selenium webdriver-manager</code></pre>
        </div>

        <div class="step">
          <h3>Passo 3: Salvar os Arquivos</h3>
          <p>Crie uma pasta no seu computador. Salve o script Python abaixo como <code>soletra_bot.py</code> dentro dessa pasta. Em seguida, certifique-se de que o seu arquivo de dicionário (ex: <code>palavras2.txt</code>) também está <strong>na mesma pasta</strong>.</p>
        </div>
        
        <div class="step">
          <h3>Passo 4: Executar!</h3>
          <p>Navegue até a pasta que você criou no seu terminal e execute o script com o comando:</p>
          <pre><code>python soletra_bot.py</code></pre>
        </div>

        <div class="step">
            <h3>Código do Robô (soletra_bot.py)</h3>
            <pre><code class="python-code"># Conteúdo do seu script Python aqui...
import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
from selenium.common.exceptions import TimeoutException
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# --- PARTE 1: O "CÉREBRO" DO ROBÔ ---
def normalizar_palavra(texto):
    texto = texto.lower()
    mapa_acentos = {
        'á': 'a', 'à': 'a', 'â': 'a', 'ã': 'a',
        'é': 'e', 'ê': 'e',
        'í': 'i',
        'ó': 'o', 'ô': 'o', 'õ': 'o',
        'ú': 'u',
    }
    texto_normalizado = "".join(mapa_acentos.get(char, char) for char in texto)
    return texto_normalizado

def carregar_dicionario(caminho_arquivo='Robo-soletra\int\palavred.txt'):
    print(f"Carregando o dicionário '{caminho_arquivo}'...")
    try:
        with open(caminho_arquivo, 'r', encoding='utf-8') as f:
            palavras = {linha.strip() for linha in f}
            print(f"Dicionário carregado com {len(palavras)} palavras.")
            return palavras
    except FileNotFoundError:
        print(f"ERRO CRÍTICO: O arquivo de dicionário '{caminho_arquivo}' não foi encontrado.")
        return None

def encontrar_palavras_validas(letras_disponiveis, letra_central, dicionario):
    print("Caçando palavras válidas...")
    palavras_encontradas = []
    letra_central_norm = normalizar_palavra(letra_central)
    letras_disponiveis_norm_set = set(normalizar_palavra(letras_disponiveis))
    for palavra_original in dicionario:
        if len(palavra_original) < 4:
            continue
        palavra_norm = normalizar_palavra(palavra_original)
        if letra_central_norm not in palavra_norm:
            continue
        if set(palavra_norm).issubset(letras_disponiveis_norm_set):
            palavras_encontradas.append(palavra_original)
    palavras_encontradas.sort(key=len)
    print(f"Sucesso! {len(palavras_encontradas)} palavras válidas foram encontradas.")
    return palavras_encontradas

# --- PARTE 2: AUTOMAÇÃO DO JOGO ---
def jogar_soletra():
    dicionario = carregar_dicionario()
    if not dicionario:
        return
    print("\\nIniciando o navegador...")
    servico = Service(ChromeDriverManager().install())
    navegador = webdriver.Chrome(service=servico)
    wait = WebDriverWait(navegador, 15)
    try:
        navegador.get("https://g1.globo.com/jogos/soletra/")
        navegador.maximize_window()
        print("Página carregada.")
        try:
            wait.until(EC.element_to_be_clickable((By.ID, "cookie-ok-button"))).click()
            print("Pop-up de cookies fechado.")
        except TimeoutException:
            print("Nenhum pop-up de cookie encontrado.")
        wait.until(EC.element_to_be_clickable((By.XPATH, "//*[text()='Iniciar']"))).click()
        print("Botão 'Iniciar' clicado.")
        try:
            wait.until(EC.element_to_be_clickable((By.XPATH, "//*[text()='Jogar']"))).click()
            print("Botão 'Jogar' do tutorial clicado.")
        except TimeoutException:
            print("Nenhuma tela de tutorial encontrada.")
        print("\\n--- Jogo iniciado! Lendo o tabuleiro... ---")
        wait.until(EC.visibility_of_element_located((By.CLASS_NAME, "letters")))
        time.sleep(0.6)
        letra_central = navegador.find_element(By.CSS_SELECTOR, ".hexagon-cell.center .cell-letter").text
        letras_laterais_elementos = navegador.find_elements(By.CSS_SELECTOR, ".hexagon-cell.outer .cell-letter")
        letras_laterais_texto = "".join([letra.text for letra in letras_laterais_elementos])
        letras_disponiveis = letras_laterais_texto + letra_central
        print(f"Letras disponíveis: {letras_disponiveis.upper()}")
        print(f"Letra obrigatória: {letra_central.upper()}")
        palavras_para_jogar = encontrar_palavras_validas(letras_disponiveis, letra_central, dicionario)
        if not palavras_para_jogar:
            print("\\nNenhuma palavra foi encontrada no dicionário para as letras de hoje.")
        else:
            print(f"\\n--- Começando a digitar as {len(palavras_para_jogar)} respostas ---")
            campo_resposta = wait.until(EC.presence_of_element_located((By.CSS_SELECTOR, "input[placeholder='Digite ou clique']")))
            botao_confirmar = wait.until(EC.element_to_be_clickable((By.XPATH, "//*[text()='Confirmar']")))
            for i, palavra in enumerate(palavras_para_jogar):
                campo_resposta.send_keys(palavra)
                time.sleep(0.3)
                botao_confirmar.click()
                print(f"({i+1}/{len(palavras_para_jogar)}) Enviada: {palavra}")
                time.sleep(0.5) 
            print("\\nTodas as palavras foram enviadas! Jogo concluído.")
    except Exception as e:
        print(f"\\nOcorreu um erro inesperado durante a automação: {e}")
    finally:
        print("\\nO robô vai fechar em 30 segundos para você ver o resultado.")
        time.sleep(10)
        navegador.quit()

if __name__ == "__main__":
    jogar_soletra()
</code></pre>
        </div>
      </div>
    </main>
    <footer>
      <p>Interface criada para demonstrar e guiar a execução de um script de automação em Python.</p>
    </footer>
  </div>
  <script type="module" src="Robo-soletra\int\index.tsx"></script>
</body>
</html>
